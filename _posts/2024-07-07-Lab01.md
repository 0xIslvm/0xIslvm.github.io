---
title: PMA Labs 
description: Practical Malware Analysis (PMA) Lab01 .
categories: [PMA]
date: 2025-7-7 00:33:00 +0800
tags: [PMA Labs,Malware analysis ,analysis]
pin: true
math: true
mermaid: true
image:
  path: "../assets/img/PMA-Labs/lab01/logo.png"
  alt: Chapter 1 Basic Static Techniques
---
##  _Lab 1-1_

![Chapter 1](../assets/img/PMA-Labs/lab01/ch1.png)
_Chapter 1_

---
### üìù Summary
In this lab, we analyze `Lab01-01.exe` and `Lab01-01.dll` using static analysis techniques.  
Our goal is to identify suspicious characteristics, determine the purpose of the files, and extract any host-based or network-based indicators.  
We use tools such as **PE Studio**, **PEiD**, **PEview**, **Strings**, **Dependency Walker**, **Detect It Easy**, and **VirusTotal**.

---

### üìç Question 1: VirusTotal Detections

**Do either files match any existing antivirus signatures?**

#### üü© `Lab01-01.exe`
![Lab01-01.exe](../assets/img/PMA-Labs/lab01/q1-lab1-.exe.png)

- **Detection Ratio:** `56 / 71`
- **Common AV Detections:**
  - `CrowdStrike Falcon`: *Win/malicious_confidence_100%*
  - `AVG`: *Win32:MalwareX-gen*

#### üü® `Lab01-01.dll`
![Lab01-01.dll](../assets/img/PMA-Labs/lab01/q1-lab1-dll.png)

- **Detection Ratio:** `46 / 72`
- **Common AV Detections:**
  - `AVG`: *Win32:Malware-gen*
  - `Bitdefender`: *Gen:Variant.Doina.76618*

---

### üìç Question 2: Compilation Timestamps

**When were these files compiled?**

| File            | Compilation Time (UTC)          |
|-----------------|----------------------------------|
| `Lab01-01.exe`  | Sun Dec 19 16:16:19 2010         |
| `Lab01-01.dll`  | Sun Dec 19 16:16:38 2010         |

![Lab01-01.exe](../assets/img/PMA-Labs/lab01/q2-lab1-exe.png)
![Lab01-01.dll](../assets/img/PMA-Labs/lab01/q2-lab1-dll.png)

---

### üìç Question 3: Packed or Obfuscated?

**Are there any indications that either file is packed or obfuscated?**

#### üü© `Lab01-01.exe`
- PEiD identifies compiler as **Microsoft Visual C++ 6.0**
- Strings are clearly visible
- Normal entropy values
- Standard section names like `.text`, `.data`, `.rdata`
- Virtual size ‚âà Raw size

![q3-exe](../assets/img/PMA-Labs/lab01/q3-1-lab1-exe.png)
![q3-exe](../assets/img/PMA-Labs/lab01/q3-2-lab1-exe.png)
![q3-exe](../assets/img/PMA-Labs/lab01/q3-3-lab1-exe.png)
![q3-exe](../assets/img/PMA-Labs/lab01/q3-4-lab1-exe.png)

#### üü® `Lab01-01.dll`
Same characteristics as above:

![q3-dll](../assets/img/PMA-Labs/lab01/q3-1-lab1-dll.png)
![q3-dll](../assets/img/PMA-Labs/lab01/q3-2-lab1-dll.png)
![q3-dll](../assets/img/PMA-Labs/lab01/q3-3-lab1-exe.png)
![q3-dll](../assets/img/PMA-Labs/lab01/q3-4-lab1-exe.png)

> **Conclusion:** There is no indication that these files are packed or obfuscated.

---

### üìç Question 4: Suspicious Imports

**Do any imports hint at what this malware does?**

#### üü© `Lab01-01.exe`
![q4-exe](../assets/img/PMA-Labs/lab01/q4-lab1-exe.png)

**Key Imports:**
- `CopyFileA`
- `FindFirstFileA()`
- `FindNextFileA()`

> Indicates file enumeration and manipulation functionality.

#### üü® `Lab01-01.dll`
![q4-dll](../assets/img/PMA-Labs/lab01/q4-lab1-dll.png)

**Key Imports:**
- `CreateMutexA()` ‚Äì ensures single instance
- `CreateProcessA()` ‚Äì spawns new processes
- `Sleep()` ‚Äì possible anti-analysis
- `WSAStartup()`, `socket()`, `connect()` ‚Äì network communication (C2)

---

### üìç Question 5: Host-Based Indicators

**Are there any files or artifacts to look for on infected systems?**

#### üü© `Lab01-01.exe`
![q5-exe](../assets/img/PMA-Labs/lab01/q5-lab1-exe.png)

> Possible copied path: `C:\windows\system32\kerne132.dll`

#### üü® `Lab01-01.dll`
![q5-dll](../assets/img/PMA-Labs/lab01/q5-lab1-dll.png)

> Hardcoded IP address: `127.26.152.13`

---

### üìç Question 6: Network-Based Indicators

**What network-based indicators could be used to detect this malware?**

#### üü© `Lab01-01.exe`
> No observed network indicators

#### üü® `Lab01-01.dll`
![q6-dll](../assets/img/PMA-Labs/lab01/q6-lab1-dll.png)

> Connects to: `127.26.152.13`

---

### üìç Question 7: Purpose of the Files

**What is the suspected purpose of these files?**

#### üü© `Lab01-01.exe`
> Its purpose is to deploy and execute the malicious DLL on the system, potentially copying it to the System32 directory for persistence.

#### üü® `Lab01-01.dll`
> Its purpose is to function as a backdoor or Remote Access Trojan (RAT) ‚Äî enabling file system access and communication with a C2 server.

---
---

##  _Lab 1-2_
### üìù Summary

In this lab, we analyze Lab01-02.exe using static analysis techniques.
Our goal is to identify suspicious characteristics, understand the program‚Äôs functionality, and extract any host-based or network-based indicators of compromise (IOCs).

---

### üîç Questions
- [ ] 1.Upload the Lab01-02.exe file to http://www.VirusTotal.com/. Does it match any existing antivirus definitions?
- [ ] 2.Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.
- [ ] 3.Do any imports hint at this program‚Äôs functionality? If so, which imports are they and what do they tell you?
- [ ] 4.What host- or network-based indicators could be used to identify this malware on infected machines?

---

### üìç Question 1: VirusTotal Detections

**Does `Lab01-02.exe` match any known antivirus signatures?**

#### üü• `Lab01-02.exe`
![q1](../assets/img/PMA-Labs/lab01/q1-lab1-2.png)

- **Detection Ratio:** `59 / 72`
- **Common AV Detections:**
  - `Avast`: *Win32:Malware-gen*
  - `AVG`: *Win32:Malware-gen*

---

### üìç Question 2: Packed or Obfuscated?

**Are there any indications that this file is packed or obfuscated? If so, what are they?**

#### üü• `Lab01-02.exe`
![q2-1](../assets/img/PMA-Labs/lab01/q2-1-lab1-2.png)

- **Packing Detected:**  
  Using **Detect It Easy**, the file is identified as packed with **UPX (Ultimate Packer for eXecutables)**.

![q2-2](../assets/img/PMA-Labs/lab01/q2-2-lab1-2.png)

- **Supporting Indicators:**
  - Sections named **UPX0** and **UPX1**
  - A large difference between **Virtual Size** and **Raw Size**
  - Very limited imported functions (typical of UPX-packed binaries)
  - No visible readable strings in the initial state

![q2-3](../assets/img/PMA-Labs/lab01/q2-3-lab1-2.png)

```bash
# Unpack Lab with UPX
upx -d Lab01-02.exe -o Unpacked.exe
```

